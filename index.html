<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>El Canicilier</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Bitter:wght@400;700;800;900&display=swap" rel="stylesheet">

<style>
    body { margin:0; padding:0; font-family:"Bitter",serif; }

    /* HEADER FIJO */
    .sticky-header {
        position: sticky;
        top: 0;
        background: #fff;
        z-index: 999;
        border-bottom: 1px solid #eee;
    }

    .header-top {
        display:flex;
        justify-content:space-between;
        align-items:center;
        padding:12px 20px;
    }

    .header-logo {
        font-family:"Montserrat",sans-serif;
        font-size:46px;
        font-weight:700;
        color:#EACB26;
    }

    .weather-box {
        font-family:"Montserrat",sans-serif;
        font-size:16px;
        display:flex;
        align-items:center;
        gap:6px;
    }

    .top-bar {
        background:#EACB26;
        padding:10px 20px;
        display:flex;
        justify-content:space-between;
        font-family:"Montserrat",sans-serif;
        font-size:15px;
    }

    /* DESKTOP MAIN */
    .desktop-main {
        max-width: 1200px;
        margin:20px auto;
        padding:0 20px;
        display:grid;
        grid-template-columns: 1fr 1fr;
        gap:30px;
    }

    .primary img { width:100%; height:380px; object-fit:cover; border-radius:4px; }
    .primary h1 { font-size:40px; font-weight:800; margin:15px 0 5px; }
    .primary h2 { font-size:20px; color:#555; margin-top:0; }

    /* GRID 2×2 NOTICIAS 2–5 */
    .grid-2x2 {
        display:grid;
        grid-template-columns:1fr 1fr;
        gap:20px;
    }
    .grid-2x2-item img { width:100%; height:160px; object-fit:cover; border-radius:4px; }
    .grid-2x2-item h3 { font-size:22px; margin:10px 0 0; font-weight:800; }

    /* FEED 6+ */
    .feed {
        max-width:1200px;
        margin:40px auto;
        padding:0 20px;
        display:grid;
        grid-template-columns: repeat(3, 1fr);
        gap:25px;
    }
    .feed-item img { width:100%; height:200px; object-fit:cover; border-radius:4px; }
    .feed-item h4 { font-size:20px; margin-top:8px; font-weight:800; }

    /* MOBILE FIX: UNA NOTICIA POR FILA, SUBTITULO SOLO EN LA PRIMERA */
    @media(max-width:850px){
        .desktop-main {
            grid-template-columns:1fr !important;
        }
        .grid-2x2 {
            grid-template-columns:1fr !important;
        }
        .feed {
            grid-template-columns:1fr !important;
        }

        .primary img { height:260px; }
        .grid-2x2-item img,
        .feed-item img { height:220px; }

        /* Ocultar subtítulo en mobile para noticias 2..n */
        .grid-2x2-item h2,
        .feed-item h2 {
            display:none !important;
        }
    }
</style>
</head>
<body>

<!-- HEADER -->
<div class="sticky-header">
    <div class="header-top">
        <div style="font-size:28px;cursor:pointer;">☰</div>
        <div class="header-logo">elCanicilier</div>
        <div class="weather-box">⛅ <span id="temp"></span>°C Buenos Aires</div>
    </div>
</div>

<!-- BARRA AMARILLA -->
<div class="top-bar">
    <div id="fecha-hoy"></div>
    <div id="dolar-info">Cargando dólar...</div>
</div>

<!-- DESKTOP MAIN -->
<div class="desktop-main">
    <div class="primary" id="primary"></div>
    <div class="grid-2x2" id="grid-2x2"></div>
</div>

<!-- FEED -->
<div class="feed" id="feed"></div>

<script>
// Fecha dinámica
document.getElementById("fecha-hoy").textContent = new Date().toLocaleDateString("es-ES", {
    weekday:"long", year:"numeric", month:"long", day:"numeric"
});

// Clima
fetch("https://api.open-meteo.com/v1/forecast?latitude=-34.60&longitude=-58.38&current_weather=true")
.then(r=>r.json())
.then(d=>{ document.getElementById("temp").textContent = Math.round(d.current_weather.temperature); });

// Dólar
fetch("https://api.bluelytics.com.ar/v2/latest")
.then(r=>r.json())
.then(d=>{
    document.getElementById("dolar-info").innerHTML =
      `Dólar: BNA $${d.oficial.value_buy} / $${d.oficial.value_sell} · Blue $${d.blue.value_buy} / $${d.blue.value_sell}`;
});

// Google Sheet
const sheetId = "1ocZG8kFq8j2sZtg_5k3ZCr8zy0TnkfkXCFOiFV1qLL4";
const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`;

fetch(url).then(r=>r.text()).then(t=>{
    let jsonText = t.substring(t.indexOf("{"), t.lastIndexOf("}") + 1);
    const json = JSON.parse(jsonText);
    const rows = json.table.rows;

    /* ---------- PRIMARY NEWS ---------- */
    const p = rows[0].c;
    document.getElementById("primary").innerHTML = `
        <img src="${p[1]?.v || ""}">
        <h1>${p[0]?.v || ""}</h1>
        <h2>${p[2]?.v || ""}</h2>
    `;

    /* ---------- 2–5 GRID ---------- */
    let g = "";
    for (let i = 1; i <= 4 && i < rows.length; i++) {
        const c = rows[i].c;
        if (!c) continue;
        g += `
            <div class="grid-2x2-item">
                <img src="${c[1]?.v || ""}">
                <h3>${c[0]?.v || ""}</h3>
            </div>`;
    }
    document.getElementById("grid-2x2").innerHTML = g;

    /* ---------- FEED 6+ ---------- */
    let f = "";
    for (let i = 5; i < rows.length; i++) {
        const c = rows[i].c;
        if (!c) continue;
        f += `
            <div class="feed-item">
                <img src="${c[1]?.v || ""}">
                <h4>${c[0]?.v || ""}</h4>
            </div>`;
    }
    document.getElementById("feed").innerHTML = f;
});
</script>

</body>
</html>
